
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>renwu28</title>
  <script src='//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js'></script>
  <style>
    *{
      margin: 0px;
      padding: 0px;
    }
    .title{
      height: 200px;
      background-color: #660;
      margin: 10px;
    }
    .menu{
      height: 50px;
      background-color: #328;
      margin: 10px;
    }
    .full{
      margin: 10px;  
    }  
    .left{
      float: left;
      min-height: 400px;
      width: 200px;
      background-color: #656;
    }
    .main{
      min-height: 1000px;
      background-color: #606;
      margin-left: 210px;
      overflow: auto;
    }
    .grey{
    	background-color: grey;
    }
    .backtop{
      width: 50px;
      height: 50px;
      position: fixed;
      top: 800px;
      right: 50px;
      background-color: grey;
      opacity: 0.8;
      z-index: 10;
      font-size: 50px;
      line-height: 50px;
      vertical-align:middle;
      text-align:center;
      display: none;
    }
    .backtop a{
      text-decoration:none;
    }
  </style>
</head>
<body>
  <div class="title">标题</div>
  <div class="menu">菜单栏</div>
  <div class="full">
    <div class="left">侧边栏</div>
    <div class="main clear">主要内容</div>
  </div>
  <div class="menu grey">菜单栏</div>
  <div class="full">
    <div class="left">侧边栏</div>
    <div class="main clear">主要内容</div>
  </div>
  <div class="backtop"><a href="#">T</a></div>
  <script>
  var test=(function(){
      $('.menu').each(function(){
      var $menu=$(this),
      		$full=$('.full'),
      		$menuH=$menu.offset().top,
      		$menuL=$menu.offset().left,
      		$menuclone=$menu.clone().css({display: 'none'}).insertBefore($menu);	
      	
      	$(window).on('scroll', function(){
      		if($(this).scrollTop()>= $menuH){
      			if(!statefix()){
      				startfix();
      				$menu.data('state',1);
      			}
      		}
      		else{
      			if(!!statefix()){
      				stopfix();
      				$menu.data('state',0);
      			}
      		}
      	})
      	function statefix(){
      		return $menustate=$menu.data('state');
      	}
      	
      	function startfix(){
      		$menuclone.css({
      			position:'fixed',
      			top:'0',
      			width:$menu.width(),
      			'z-index':'100'
      		})
      		$menuclone.show();
      		$menu.css({
      			opacity:'0',
      		})
      	}
      	function stopfix(){
      		$menuclone.hide();
      		$menu.css({
      			opacity:'1',
      		})
      	}

      })

      function top(){
        $(window).on('scroll', function(){
          if($('body').scrollTop()>= 100){
            $('.backtop').show();
          }
          else{
            $('.backtop').hide();
          }
        })

        $('.backtop').on('click', function(){
          $('body').scrollTop(0);
        })
      }
      return {
        top:top
      }
  })()

  test.top();
  </script>
</body>
</html>
